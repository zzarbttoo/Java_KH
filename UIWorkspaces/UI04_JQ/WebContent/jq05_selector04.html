<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<script type="text/javascript" src="resources/js/jquery-3.5.1.min.js"></script>
<script type="text/javascript">

	$(document).ready(function() {

		//.submit() : form 에서 submit 이벤트가 발생되면 실행
		$("#signal").submit(function() {

			if ($(".infobox").val == null || $(".infobox").val() == "") {
				//화면이 보여지고 나서 action 속성이 없기 때문에 나에게 화면이 전달된 것
				$(".error").show();

				//event 전파를 막아준다
				return false;

			}

		});

		$("#confirm").click(function() {

			$("#result").empty();

			if ($("input[name=chk]:checked").length == 0) {
				alert("하나 이상 체크해 주세요");
			} else {

				var sum = 0;
				$("input[name = chk]:checked").each(function(i) {

					var chk = $("input[name=chk]:checked").eq(i);

					//sum += parseInt(chk[0].value);
					
					var book = chk.next().text();
					var price = chk.val();
					$("#result").append(book + ":" + price  +"<br/>");
					
					sum += parseInt(price);
					

				});
				$("#result").append("책의 총 합 = " + sum +" 원");
			}

		});

		//체크박스 하나라도 페크 해제되면 전체선택 해제
			$("input[name=chk]").click(function(){
			
			if($("input[name=chk]").length == $("input[name=chk]:checked").length){
				$("input[name=all]").prop("checked", true);
				
			}else{
				
				$("input[name=all]").prop("checked", false);
				
			}
		});
		
		/*
			.prop() : javascript 의 property
			.attr() : html의 attribute
			https://ojava.tistory.com/133
		
		*/
		

		
	})
	
		//체크박스 모두 체크되면 전체선택 체크
		function allchk(bool){
			//callback 함수
			$("input[name=chk]").each(function(){
				
				//this: each를 통해 가져온 하나(함수가 적용되는 하나)
				//attr로 했을 때 사람 손을 한번 탄 친구는 다시 바뀌지 않는다(전체 선택을 할지라도!)
				//그래서 attr 대신 prop을 써야한다
				$(this).prop("checked", bool);
				
			});
		}

</script>




<body>

	<form action="" id="signal" method="get">
		<div>
			<span class="label">User ID</span> <input type="text" class="infobox"
				name="userid" />
			<!-- 유효성 검사 -->
			<span class="error" hidden="" style="color: red">반드시 입력하세요!!!</span>
		</div>

		<input type="submit" class="submit" value="입력" />
	</form>

	<hr />

	<fieldset style="width: 300px">

		<legend>체크 여부 확인</legend>
		<input type="checkbox" name="all" onclick="allchk(this.checked)" />전체
		선택<br /> <input type="checkbox" name="chk" value="25000" /><b>JAVA</b><br />
		<input type="checkbox" name="chk" value="30000" /><b>DataBase</b><br />
		<input type="checkbox" name="chk" value="40000" /><b>JavaScript</b><br />

		<input type="button" value="확인" id="confirm" /><br /> <span>선택한
			책 가격</span>
		<div id="result"></div>

	</fieldset>




</body>
</html>